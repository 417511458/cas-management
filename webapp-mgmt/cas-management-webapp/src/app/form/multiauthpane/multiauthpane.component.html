<div>
  <mat-form-field class="textInput">
    <mat-select
            placeholder="Policy"
            [(ngModel)]="type"
            (change)="changeType()">
      <mat-option *ngFor="let opt of types; let i = index" [value]="opt">
        {{ display[i] }}
      </mat-option>
    </mat-select>
  </mat-form-field>
</div>

<ng-container *ngIf="type === TYPE.DEFAULT">
  <app-input field="multifactorAuthenticationProviders"
             [change]="policy"
             [orig]="data.diff.multifactorPolicy">
    <mat-form-field class="textInput">
      <mat-placeholder i18n-placeholder="services.form.label.multiauth.providers">
       {{ messages.services_form_label_multiauth_providers }}
      </mat-placeholder>
      <mat-select multiple
             [(ngModel)]="policy.multifactorAuthenticationProviders">
        <mat-option *ngFor="let opt of formData.mfaProviders" [value]="opt.value">
          {{ opt.display }}
        </mat-option>
      </mat-select>
      <mat-hint align="end">
        <app-hint></app-hint>
      </mat-hint>
    </mat-form-field>
    <mat-icon appHelp
             i18n-matTooltip="services.form.tooltip.multiauth_providers"
             [matTooltip]="messages.services_form_tooltip_multiauth_providers">
    </mat-icon>
  </app-input>

  <app-input field="failureMode" [change]="policy" [orig]="data.diff.multifactorPolicy">
    <mat-form-field class="textInput">
      <mat-placeholder i18n-placeholder="services.form.label.multiauth.failuremode">
        {{ messages.services_form_label_multiauth_failuremode }}
      </mat-placeholder>
      <mat-select [(ngModel)]="policy.failureMode">
        <mat-option *ngFor="let opt of formData.mfaFailureModes" [value]="opt">
          {{ opt }}
        </mat-option>
      </mat-select>
      <mat-hint align="end">
        <app-hint></app-hint>
      </mat-hint>
    </mat-form-field>
    <mat-icon appHelp
             i18n-matTooltip="services.form.tooltip.multiauth.failuremode"
             [matTooltip]="messages.services_form_tooltip_multiauth_failuremode">
    </mat-icon>
  </app-input>

  <app-input field="principalAttributeNameTrigger"
             [change]="policy"
             [orig]="data.diff.multifactorPolicy">
    <mat-form-field class="textInput">
      <mat-placeholder i18n-placeholder="services.form.label.multiauth.principalattribute.nametrigger">
        {{ messages.services_form_label_multiauth_principalattribute_nametrigger }}
      </mat-placeholder>
      <input matInput [matAutocomplete]="auto"
             [(ngModel)]="policy.principalAttributeNameTrigger">
      <mat-hint align="end">
        <app-hint></app-hint>
      </mat-hint>
    </mat-form-field>
    <mat-icon appHelp
             i18n-matTooltip="services.form.tooltip.multiauth.principalattribute.nametrigger"
             [matTooltip]="messages.services_form_tooltip_multiauth_principalattribute_nametrigger">
    </mat-icon>
    <mat-autocomplete style="width:300px" #auto="matAutocomplete">
      <mat-option *ngFor="let opt of formData.availableAttributes" [value]="opt">{{ opt }}</mat-option>
    </mat-autocomplete>
  </app-input>

  <app-input field="principalAttributeValueToMatch"
             [change]="policy"
             [orig]="data.diff.multifactorPolicy">
    <mat-form-field class="textInput">
      <mat-placeholder i18n-placeholder="services.form.label.multiauth.principalattribute.valuetomatch">
        {{ messages.services_form_label_multiauth_principalattribute_valuetomatch }}
      </mat-placeholder>
      <input matInput [(ngModel)]="policy.principalAttributeValueToMatch">
      <mat-hint align="end">
        <app-hint></app-hint>
      </mat-hint>
    </mat-form-field>
    <mat-icon appHelp
             i18n-myTooltip="services.form.tooltip.multiauth.principalattribute.valuetomatch"
             [matTooltip]="messages.services_form_tooltip_multiauth_principalattribute_valuetomatch">
    </mat-icon>
  </app-input>

  <app-input field="bypassEnabled" [change]="policy" [orig]="data.diff.multifactorPolicy">
    <mat-checkbox [(ngModel)]="policy.bypassEnabled">
      <ng-container i18n="services.form.label.multiauth.bypassenabled">
        {{ messages.services_form_label_multiauth_bypassenabled }}
      </ng-container>
      <mat-icon appHelp
               i18n-matTooltip="services.form.tooltip.multiauth.bypassenabled"
               [matTooltip]="messages.services_form_tooltip_multiauth_bypassenabled">
      </mat-icon>
      <mat-hint align="end">
        <app-hint></app-hint>
      </mat-hint>
    </mat-checkbox>
  </app-input>
</ng-container>

<ng-container *ngIf="type === TYPE.GROOVY">
  <app-input field="groovyScript" [change]="policy" [orig]="data.diff.multifactorPolicy">
    <mat-form-field class="textInput">
      <mat-placeholder i18n-placeholder="services.form.label.multiauth.groovy.scriptFile">
        {{ messages.services_form_label_multiauth_groovy_scriptFile }}
      </mat-placeholder>
      <input matInput [(ngModel)]="policy.groovyScript">
    </mat-form-field>
    <mat-hint align="end">
      <app-hint></app-hint>
    </mat-hint>
    <mat-icon appHelp
              i18n-matTooltip="services.form.tooltip.multiauth.grrovy.scriptFile"
              [matTooltip]="messages.services_form_tooltip_multiauth_groovy_scriptFile">
    </mat-icon>
  </app-input>
</ng-container>
